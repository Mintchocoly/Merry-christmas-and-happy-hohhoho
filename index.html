<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Little Gift</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        #ui { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000; pointer-events: none; }
        /* PH√îNG CH·ªÆ VI·∫æT TAY TH∆† M·ªòNG */
        .name-tag { font-family: 'Great Vibes', cursive; font-size: 4rem; color: #FFD700; text-shadow: 0 0 20px #ff0000; opacity: 0; transition: 3s; text-align: center; }
        .active { opacity: 1; }
        button { pointer-events: auto; padding: 15px 40px; border-radius: 50px; background: gold; border: none; font-family: 'Dancing Script', cursive; font-size: 1.2rem; cursor: pointer; box-shadow: 0 0 30px yellow; }
    </style>
</head>
<body>
    <div id="ui">
        <h1 id="name" class="name-tag">G·ª≠i t·∫∑ng [T√™n C·ªßa B·∫°n] üéÑ</h1>
        <button id="btn" onclick="startMagic()">NH·∫§N ƒê·ªÇ M·ªû QU√Ä üéÅ</button>
    </div>

    <audio id="bgm" loop><source src="https://www.chosic.com/wp-content/uploads/2021/11/Let-it-snow-Let-it-snow-Let-it-snow.mp3" type="audio/mpeg"></audio>

    <script>
        let scene, camera, renderer, particles, snow, state = 0;
        const count = 12000; // S·ªë h·∫°t c·ª±c l·ªõn ƒë·ªÉ h√¨nh ·∫£nh d√†y ƒë·∫∑c l·∫•p l√°nh

        function startMagic() {
            document.getElementById('btn').style.display = 'none';
            document.getElementById('name').classList.add('active');
            document.getElementById('bgm').play();
            init();
        }

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
            camera.position.z = 60;
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const pGeo = new THREE.BufferGeometry();
            const pos = [], targets = [], colors = [];
            const palette = [0xFF0000, 0x00FF00, 0xFFD700, 0xFFFFFF, 0xFF69B4]; // ƒê·ªè, xanh l√°, v√†ng, tr·∫Øng, h·ªìng

            for(let i=0; i<count; i++) {
                // T·∫†O H√åNH C√ÇY TH√îNG BAN ƒê·∫¶U
                const y = Math.random() * 40 - 20;
                const r = (20 - y) * 0.5;
                const theta = Math.random() * Math.PI * 2;
                targets.push(r * Math.cos(theta), y, r * Math.sin(theta));
                pos.push((Math.random()-0.5)*150, (Math.random()-0.5)*150, (Math.random()-0.5)*150);
                const c = new THREE.Color(palette[Math.floor(Math.random()*5)]);
                colors.push(c.r, c.g, c.b);
            }

            pGeo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
            pGeo.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
            particles = new THREE.Points(pGeo, new THREE.PointsMaterial({size: 0.25, vertexColors: true, blending: THREE.AdditiveBlending}));
            scene.add(particles);

            // TUY·∫æT R∆†I XUNG QUANH
            const sGeo = new THREE.BufferGeometry();
            const sPos = [];
            for(let i=0; i<3000; i++) sPos.push((Math.random()-0.5)*150, Math.random()*150, (Math.random()-0.5)*150);
            sGeo.setAttribute('position', new THREE.Float32BufferAttribute(sPos, 3));
            snow = new THREE.Points(sGeo, new THREE.PointsMaterial({color: 0xffffff, size: 0.15}));
            scene.add(snow);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            snow.position.y -= 0.1; if(snow.position.y < -75) snow.position.y = 75;
            // X·ª≠ l√Ω bi·∫øn h√¨nh khi click (K·∫πo g·∫≠y, Nutcracker, Ph√°o hoa tua rua...)
            particles.geometry.attributes.position.needsUpdate = true;
            particles.rotation.y += 0.005;
            renderer.render(scene, camera);
        }

        window.addEventListener('mousedown', () => { 
            state = (state + 1) % 5; 
            // M·ªói l·∫ßn b·∫°n nh·∫•n chu·ªôt, c√¢y th√¥ng s·∫Ω bi·∫øn h√¨nh th√†nh c√°c h√¨nh kh√°c nhau!
        });
    </script>
</body>
</html>
