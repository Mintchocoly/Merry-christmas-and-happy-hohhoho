<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>The Perfect Christmas Tree</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Great+Vibes&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        #intro { position: fixed; width: 100%; height: 100%; background: #000; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 999; }
        .gift-title { font-family: 'Great Vibes', cursive; font-size: 5rem; color: #fff; text-shadow: 0 0 20px gold; margin-bottom: 30px; }
        #open-btn { padding: 15px 60px; border-radius: 50px; background: gold; border: none; font-family: 'Dancing Script', cursive; font-size: 2.2rem; cursor: pointer; box-shadow: 0 0 30px gold; }
        #footer-name { position: fixed; bottom: 30px; right: 30px; font-family: 'Dancing Script', cursive; font-size: 2rem; color: gold; opacity: 0; transition: 3s; z-index: 100; text-shadow: 2px 2px 10px #000; }
    </style>
</head>
<body>
    <div id="intro">
        <div class="gift-title">Merry Christmas</div>
        <button id="open-btn" onclick="startShow()">Ch·∫°m ƒë·ªÉ m·ªü qu√†</button>
    </div>
    <div id="footer-name">G·ª≠i t·∫∑ng B·∫°n üéÑ</div>
    <audio id="music" loop><source src="https://www.chosic.com/wp-content/uploads/2021/11/Let-it-snow-Let-it-snow-Let-it-snow.mp3" type="audio/mpeg"></audio>

    <script>
        let scene, camera, renderer, particles, targets;
        const P_COUNT = 60000; // 6 v·∫°n h·∫°t ƒë·ªÉ c√¢y th√¥ng c·ª±c k·ª≥ d√†y v√† l·ªông l·∫´y

        function startShow() {
            document.getElementById('intro').style.display = 'none';
            document.getElementById('footer-name').style.opacity = '1';
            document.getElementById('music').play();
            initApp();
        }

        function createTreePoints() {
            const data = new Float32Array(P_COUNT * 3);
            for (let i = 0; i < P_COUNT; i++) {
                let x, y, z;
                if (i < P_COUNT * 0.8) { // TH√ÇN C√ÇY TH√îNG T·∫¶NG L·ªöP
                    let h = Math.random() * 65;
                    let r = (65 - h) * 0.35 * (Math.pow(Math.random(), 0.6) + 0.4);
                    let t = Math.random() * Math.PI * 2;
                    x = r * Math.cos(t); y = h - 35; z = r * Math.sin(t);
                } else if (i < P_COUNT * 0.9) { // NG√îI SAO V√ÄNG R·ª∞C R·ª† TR√äN ƒê·ªàNH
                    let t = Math.random() * Math.PI * 2;
                    let r = 6 * Math.random();
                    x = Math.cos(t) * r; y = 33 + Math.random()*5; z = Math.sin(t) * r;
                } else { // C√ÅC H·ªòP QU√Ä S·∫ÆC M√ÄU D∆Ø·ªöI G·ªêC
                    x = (Math.random()-0.5)*60; y = -35 + Math.random()*12; z = (Math.random()-0.5)*60;
                }
                data[i*3] = x; data[i*3+1] = y; data[i*3+2] = z;
            }
            return data;
        }

        function initApp() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
            camera.position.z = 110;
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            targets = createTreePoints();
            const geo = new THREE.BufferGeometry();
            const pos = new Float32Array(P_COUNT * 3);
            const col = new Float32Array(P_COUNT * 3);

            for (let i = 0; i < P_COUNT; i++) {
                // H·∫°t bay t·ª´ kh√¥ng gian v√†o
                pos[i*3] = (Math.random()-0.5)*1000; pos[i*3+1] = (Math.random()-0.5)*1000; pos[i*3+2] = (Math.random()-0.5)*1000;
                
                let c = new THREE.Color();
                let r = Math.random();
                if (r > 0.8) c.setHex(0xffd700); // V√†ng
                else if (r > 0.4) c.setHex(0xff3333); // ƒê·ªè
                else c.setHex(0xffffff); // Tr·∫Øng
                col[i*3] = c.r; col[i*3+1] = c.g; col[i*3+2] = c.b;
            }

            geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            geo.setAttribute('color', new THREE.BufferAttribute(col, 3));
            particles = new THREE.Points(geo, new THREE.PointsMaterial({size: 0.35, vertexColors: true, blending: THREE.AdditiveBlending}));
            scene.add(particles);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            const p = particles.geometry.attributes.position.array;
            for (let i = 0; i < P_COUNT * 3; i++) {
                p[i] += (targets[i] - p[i]) * 0.04;
            }
            particles.geometry.attributes.position.needsUpdate = true;
            particles.rotation.y += 0.005;
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
